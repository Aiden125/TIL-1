# 15. 변경가능성을 최소화하라

* 변경 불가능(inmmutable) 클래스는 그 객체를 수정할 수 없는 클래스다.
* 객체 내부의 저오븐ㄴ 객체가 생성될 때 주어진 것이며, 객체가 살아 있는 동안 그대로 보존된다.
* **우선 변경 불가능 클래스는 변경 가능 클래스보다 설꼐하기 쉽고, 구현하기 쉬우며, 사용하기도 쉽다. 오류 가능성도 적고, 더안전하다**

## 변경 불가능 클래스 5가지 규칙

1. 객체 상태를 변경하는 메서드(수정자 메스드 등)를 제공하지 않는다.
2. 계승할 수 없도록 한다
    * 그러면 잘못 작성되거나 악의적인 하위 클래스가 객체 상태가 변경된 것처럼 동작해서 변경 불가능 성을 꺠드리는 일을 막을 수 있다.
    * 계승을 금지하려면 보통 클래스를 final 선언하면 된다.
3. 모든 필드를 final로 선언하라
    * 그러면 시스템이 강제하는 형태대로 프로그래머의 의도가 분명히 드러난다.
    * 이렇게 되면 자바 메모리 모델에 명시된ㅁ바와 같이 새로 생성된 객체에 대한 참조가 동기화 없이 다른 스레드로 절달되어 안전하다.(이해 못했음...)
4. 모든 필드를 private로 선언하라
    * 그러면 클라이언트가 필드가 참조하는 변경 가능 객체를 직접 수정하는 일을 막을 수 있다.
5. 변경 가능 컴포넌에 대한 독점적 접근권을 보장하라
    * 클래스에 포함된 변경 가능 객체에 대한 참조를 클라이언트가 획득할 수 없어야 한다.

```java
public final class Complex {
    private final dobule re;
    private final dobule im;

    public Complex(dobule re, dobule im){
        this.re = re;
        this.im = im;
    }

    // 대응되는 수정자가 없는 접근자들
    public dobule realPart() {return re;}
    public dobule imaginaryPart() {return im;}

    
    public Compex add (Complex c){
        return new Compex(re+ c.re, im + c.im);
    }

}
```

* **변경 불가능 객체는 단순하다. 생성될 때 부여된 한가지 상태만 갖는다. 따라서 불변식을 확실히 따른다**
* 변경 불가능 객체는 스레드에 안전할 수밖에 없다. 어떤 동기화도 필요 없으며, 여러 스레드가 동시에 동시에 사용해도 상태가 휴ㅐ손될 일이 없다.
* 따라서 변경 불가능한 객체는 자유롭게 공유할 수 있다.
* 변경 간으한 클래스로 만들 타당한 이유가 없다면, 반드시 변경 불가능 클래스로 만들어야한다
* 변경 불가능한 클래스로 만들수 없다면, 뱐걍 가ㅣ능성을 최대한 제한하라.
* 측별한 이유가 없다면 모든 필드는 final로 선언하라

