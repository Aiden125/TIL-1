## Spring Clound Netflix

> 스프링 클라우드 넷플릭스는 자동 환경 설정과 스프링 환경 및 다른 스프링 프로그래밍 모델 관용구에 대한 바인딩을 통해 스프링 부트 애킬리케이션을 위한 넷플릭스 OSS 통합 제공한다.

스프링 클라우드는 넷플릭스의 포괄적 범위 아래에 있는 중요한 프로젝트 중 일부는 다음과 같다.

* 유레카: 마이크로서비스에 대한 서비스 ㅁ등록 및 검색 기능을 제공하는 네임 서버다.
* 히스트릭스: 서킷 브레이커를 통해 내결함성 마이크로서비스를 구축할 수 있는 기능으로, 대시 보드를 제공한다.
* 페인: 선언적인 REST 클라이언트를 사용하면 JAX-RS 및 스프링 MVC로 작성된 서비스를 쉽게 호출할 수 있다.
* 립본: 클라이언트 기준 로드 밸런싱 기능을 제공한다.
* 주울: 라우팅, 필터링, 인증 및 보안과 같은 일반적인 API 게이트웨이 기능을 제공한다. 맞춤 규식 및 필터로 확장 할 수 있다.

## Config Server
스프링 클라우드 컨피그는 중앙 집중식 마이크로 서비스 구성을 지원한다.

* 스프링 클라우드 컨피그 서버 : 버전 관리 리포지토리로 백업 된 중앙 집중식 구성을 지원한다.
* 스프링 클라우드 컨피그 클라어은트: 애플리케이션이 스프링 클라우드 컨피그 서버에 연결하도록 지원한다.

![msa-config-server](https://github.com/cheese10yun/spring-msa-demo/raw/master/assets/msa-config-server.png)

## Cloud Bus
스프링 클라우드 버스는 마이크로서비스를 카프카 및 래빗MQ 같은 경량 메시지 브로커에 연결한다

### 필요성
마이크로 서비스에 구성을 변경하려는 하려면 프로덕션 환경에 실행 중인 마이크로서비스 A의 인스턴스가 5개가 있다고 가정하면, 구성을 긴급히 변경해야할 때 `http://localhost:8080/refesh` POST 요청을 호출해야한다. 

마이크로서비스가 A 다섯 가지 실행된다. 구성 변경은 URL이 실행되는 마이크로 서비스 A의 인스턴스에만 반영된다. 다른 3개의 인스턴스는 새로 고침 요청이 실행 될 때까지 구성 변경 사항을 받지 못한다.

### 스프링 클라우드 버스를 사용해 구성 변경 전파
해결 책은 스프링 클라우드 버스를 사용해 래빗MQ와 같은 메시지 브로커를 통해 구성 변경 사항을 여러 인스턴스에 전달하는 것이다.
![msa-cloud-bus](https://github.com/cheese10yun/spring-msa-demo/raw/master/assets/msa-cloud-bus.png)

마이크로서비스 인스턴스 중 하나에 새로 고침이 호출되면, 스프링 클라우드 버스는 모든 마이크로 서비스 인스턴스에 변경 이벤트를 전달한다. 마이크로서비스는 인스턴스는 변경 이벤트 수신 시 구성 서버에 업데이트된 구성을 요청한다.
