# 자바 ORM표준 JPA 프로그래밍 정리

## 1장

### 1.2 패더라임 불일치

애플리케이션은 발전하면서 그 내부의 복잠성도 점점 커진다. 지속 가능한 애플리케이션을 개발하는 일은 끊임 없이 증가하는 복잡성과의 싸움이다. 복잠성을 제어 하지 못하면 격국 유지보수 하기 어려운 애플리케이션이 된다.

*객체 지향 프로그래밍은 추상화, 캡슐화, 정보은닉, 상속, 다형성 등 시스템의 복잡성을 제어할 수있다는 다양한 장치들을 제공한다.*

문제는 정의한 도메인 모델을 저장할 때 발생한다. 예를 들어 특정 유자가 시스템에 회원 가입하면 회원이라는 객체 인스턴스를 생상한 후에 이 객체를 메모리가 아닌 어딘가에 영구 보관 해야한다.

객체는 속성(필드)과 기능(메소드)을 가진다. 객체의 기능은 클래스에 정의도어있음으로 객체 인스턴스의 상태 속성만 저장했다가 필요할 때 불러와서 복구하면 된다. 객체가 단순하면 객체의 모든 속성 값을 꺼내서 파일이나 데이터베이스에 저장하면 되지만, 부모 객체를 상속받거나, 다른 객체를 참조하고 있다면 갹체의 상태를 저장하기는 쉽지 않다.

예를들어 회원 객체를 저장해야 하는데 회원 객체가 팀 객체를 참조하고 있다면, 회원 객체를 저장할 때 팀 객체도 함께 저장해야한다. 단순히 훠ㅣ원 객체만 저장하면 참조되는 팀 객체를 잃어버리는 문제가 발생한다.

자바는 이런 문제까지 고려해서 객체를 파일로 저장하는 직렬화 기능과 저장된 파일을 객체로 복구하는 역 직렬화 기능을 지원한다. 하지만 이 방법은 직렬화된 객체를 검색하기 어렵다는 문제가 있음으로 현실성이 없다. 현실적인 대안은 관계형 데이터베이스에 객체를 저장하는 것인데 객체형 데이터베이스는 데이터 중심으로 구조화되어 있고, 집학적인 사고를 요구한다. 그리고 객체지향에서 이야기하는 추상화, 상속, 다형성 같은 개념이 없다.

객체와 관계형 데이터베이스는 지향하는 목적이 서로 다르므로 둘의 기능과 표현 방법도 다르다. 이것을 객체와 관계형 데이터베이스의 패러다임 불일치 문제라 한다. 따라서 객체 구조를 테이블 구조에 저장하는 데는 한계가 있다.
애플리케이션은 자바라는 객체지향 언오로 개발하고 데이터는 관계형 데이터베이스에 저장해야 한다면, 패러다임의 불일치 문제를 개발자가 중간에 해결해야한다. 문제는 이런 객체와 관계형 데이터베이스 사이의 패러다임 불일치 문제를 해결하는 데 너무 많은 시간과 코드를 소비하느 데 있다.


### 1.3.2 왜 JPA를 사용해야 하는가?

* 생상성
	- JPA를 사용하면 자바 컬랙션에 객체를 저장하듯이 JPA에게 저장할 객체를 전달하면 된다.
	- 따라서 지루하고 반복정인 코드와 CRUD용 SQL 개발자가 직접 작성하지 않아도된다.
	- 데이터베이스 설계 중심의 패러다임을 객체 설계 중슴으로 역전시킬 수 있다.
* 유지보수
	- SQL을 집접 다루면 엔티티에 필드를 하나만 추가해도 관련된 등로그 수정, 조회 결과를 패밍하기 위한 JDBC APIㄹㄹ 모두 변경해야한다. 반면 JPA를 사용하면 이런 과정을 JPA가 대신 처리해주므로 필드를 추가하거나 삭제해도 수정해야 할 코드가 줄어든다.
* 패러다임의 불일치 해결
	- JPA는 상속 연과관계 객체 르개프 탐색 비교하기 같은 패러다임의 불일치 문제를 해결해준다.
* 선능
	- JPA는 애플리케이션과 데이터베이스 사엥에서 다양한 성능 최적화 기회를 제공한다.
	- 캐쉬 기능 등등등... 아직 잘모르겠다.
* 데이터 접근 추상화와 벤더 독립성
	- 관계형 데이터베이스는 같은 기능도 벤더마다 사용버이 다른 경우가 많다. 단적인예로 페이징 처리는 데이터베이스마다 달라서 사용법을 각각 배워야한다. 결국 애플리케이션은 처음 선택한 데이터베이스 기술에 종속되고 다른 데이터베이스로 변경하기는 매우 어렵다.
	- JPA는 애플리케이션과 데이터베이스 사이에 추상화된 데이터 접근 계층을 제공해서 애플리케이션이 특정 데이터베이스 기술에 종속되지 않도록 한다.

## 02 JPA 시작

### 객체 매핑
* @Entity
	- 이 클래스를 테이블과 매핑한다고 JPA에게 알려준다. 이렇게 @Entity가 사용된 클래스를 엔티티 클래스라 한다.
* @Table
	- 엔티티 클래스에 매핑할 에티블 정보를 알려준다.
* @Id
	- 엔티티 클래스의 필드를 테이블 기본키에 매핑한다.
* @Colum
	- 필드를 컬럼에 매핑한다.

### 2.5.1 데이터베이스 방언
JPA는 특정 데이터베이스에 종속적이지 않은 기술이다. 따라서 다른 다른에티어베이스로 쉽게 교체할 수있다. 그런데 각 데이터베이스가 제공하는 SQL 문법가 함수가 조금씩 다르다.
* 데이터 타입 : 가변 문자 타입으로 Mysql은 VARCHAR, 오라클은 VARCHAR2를 사용한다.
* 다른 함수명 : 문자열 자르는 함수가 mysql, oracle은 다르다.
* 페이징처리: 함수가 mysql, oracle은 다르다.
이처럼 SQL 표준을 지키지 않거나 특정 데이터베이스만의 고유한 기능을 JPA에서는 방언(Dialect) 라고 한다. 애플리케이션 개발자가 특정 데이터베이스에 종속되는 기능을 많은 사용하면 나중에 데이터베이스가 교체하기가 어렵다.이러한 문제를 하결하려고 다양한 데이터베이스 방언 클래스를 제공한다.


### 2.6.1
* 엔티티 매니저 팩토리 생성
	-
